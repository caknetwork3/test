import{d as s,u as e,r as a,o as t,a as i,c as r,b as n,e as o,f as l,w as c,v as u,t as d,F as v,g as m,h,n as f,i as g,j as p,k,l as _,m as w,p as y}from"./vendor-BGoJhWpD.js";const b=s("auth",{state:()=>({user:null,isLoggedIn:!1,users:[],notifications:[]}),getters:{isAdmin:s=>s.user&&"admin"===s.user.role,currentUser:s=>s.user,userBalance:s=>s.user?s.user.chococoins:0,unreadNotifications:s=>s.notifications.filter(s=>!s.read).length},actions:{initializeStore(){const s=localStorage.getItem("cak_users"),e=localStorage.getItem("cak_current_user"),a=localStorage.getItem("cak_notifications");s?this.users=JSON.parse(s):this.createDefaultAdmin(),e&&(this.user=JSON.parse(e),this.isLoggedIn=!0),a&&(this.notifications=JSON.parse(a))},createDefaultAdmin(){const s={id:"admin_dexo",username:"dexo",email:"dexo@cak.com",password:"123",role:"admin",chococoins:1e4,profileImage:null,bio:"Administrador principal de CAK",socialLinks:{twitch:"",youtube:"",twitter:"",instagram:""},isStreaming:!1,createdAt:(new Date).toISOString()};this.users.push(s),this.saveUsers()},register(s){if(this.users.find(e=>e.username===s.username||e.email===s.email))throw new Error("El usuario o email ya existe");const e={id:`user_${Date.now()}`,username:s.username,email:s.email,password:s.password,role:"streamer",chococoins:100,profileImage:null,bio:"",socialLinks:{twitch:"",youtube:"",twitter:"",instagram:""},isStreaming:!1,createdAt:(new Date).toISOString()};return this.users.push(e),this.saveUsers(),e},login(s){const e=this.users.find(e=>(e.username===s.username||e.email===s.username)&&e.password===s.password);if(!e)throw new Error("Credenciales incorrectas");return this.user=e,this.isLoggedIn=!0,localStorage.setItem("cak_current_user",JSON.stringify(e)),e},logout(){this.user=null,this.isLoggedIn=!1,localStorage.removeItem("cak_current_user")},updateProfile(s){if(!this.user)return;const e=this.users.findIndex(s=>s.id===this.user.id);-1!==e&&(this.users[e]={...this.users[e],...s},this.user=this.users[e],localStorage.setItem("cak_current_user",JSON.stringify(this.user)),this.saveUsers())},changePassword(s,e){if(!this.user)throw new Error("No hay usuario logueado");if(this.user.password!==s)throw new Error("ContraseÃ±a actual incorrecta");const a=this.users.findIndex(s=>s.id===this.user.id);-1!==a&&(this.users[a].password=e,this.user.password=e,localStorage.setItem("cak_current_user",JSON.stringify(this.user)),this.saveUsers())},getAllUsers(){return this.users.filter(s=>"admin"!==s.role)},updateUserBalance(s,e){if(!this.isAdmin)throw new Error("No tienes permisos de administrador");const a=this.users.findIndex(e=>e.id===s);-1!==a&&(this.users[a].chococoins=e,this.saveUsers(),this.user&&this.user.id===s&&(this.user.chococoins=e,localStorage.setItem("cak_current_user",JSON.stringify(this.user))))},deleteUser(s){if(!this.isAdmin)throw new Error("No tienes permisos de administrador");this.users=this.users.filter(e=>e.id!==s),this.saveUsers()},updateUserCredentials(s,e){if(!this.isAdmin)throw new Error("No tienes permisos de administrador");const a=this.users.findIndex(e=>e.id===s);-1!==a&&(this.users[a]={...this.users[a],...e},this.saveUsers())},addNotification(s){const e={id:`notif_${Date.now()}`,message:s.message,type:s.type||"info",read:!1,createdAt:(new Date).toISOString(),targetUsers:s.targetUsers||"all"};this.notifications.unshift(e),this.saveNotifications()},markNotificationAsRead(s){const e=this.notifications.find(e=>e.id===s);e&&(e.read=!0,this.saveNotifications())},markAllNotificationsAsRead(){this.notifications.forEach(s=>s.read=!0),this.saveNotifications()},getUserNotifications(){return this.user?this.notifications.filter(s=>"all"===s.targetUsers||Array.isArray(s.targetUsers)&&s.targetUsers.includes(this.user.id)):[]},saveUsers(){localStorage.setItem("cak_users",JSON.stringify(this.users))},saveNotifications(){localStorage.setItem("cak_notifications",JSON.stringify(this.notifications))},searchStreamers(s){if(!s)return this.users.filter(s=>"streamer"===s.role);const e=s.toLowerCase();return this.users.filter(s=>"streamer"===s.role&&(s.username.toLowerCase().includes(e)||s.bio.toLowerCase().includes(e)))},getStreamerById(s){return this.users.find(e=>e.id===s&&"streamer"===e.role)}}}),S=(s,e)=>{const a=s.__vccOpts||s;for(const[t,i]of e)a[t]=i;return a},I={class:"search-container"},N={class:"search-input-wrapper"},A={key:0,class:"search-results"},C={key:0,class:"search-loading"},U={key:1,class:"no-results"},L={key:2,class:"results-list"},E=["onClick"],O={class:"result-avatar"},x=["src","alt"],B={key:1,class:"avatar-placeholder"},D={class:"result-info"},J={class:"result-name"},$={class:"result-bio"},M={key:0,class:"streaming-badge"},R=S({__name:"SearchBar",setup(s){const h=e(),f=b(),g=a(""),p=a([]),k=a(!1),_=a(!1);let w=null;const y=()=>{w&&clearTimeout(w),g.value.trim()?(_.value=!0,w=setTimeout(()=>{p.value=f.searchStreamers(g.value),_.value=!1},300)):p.value=[]},S=s=>{s.target.closest(".search-container")||(k.value=!1)},R=s=>{"Escape"===s.key&&(k.value=!1,g.value="")};return t(()=>{document.addEventListener("click",S),document.addEventListener("keydown",R)}),i(()=>{document.removeEventListener("click",S),document.removeEventListener("keydown",R),w&&clearTimeout(w)}),(s,e)=>(n(),r("div",I,[o("div",N,[c(o("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>g.value=s),onInput:y,onFocus:e[1]||(e[1]=s=>k.value=!0),type:"text",placeholder:"Buscar streamers, perfiles...",class:"search-input"},null,544),[[u,g.value]]),e[2]||(e[2]=o("div",{class:"search-icon"},"ðŸ”",-1))]),k.value&&g.value?(n(),r("div",A,[_.value?(n(),r("div",C,e[3]||(e[3]=[o("div",{class:"loading"},null,-1),o("span",null,"Buscando...",-1)]))):0===p.value.length?(n(),r("div",U,[o("span",null,'No se encontraron resultados para "'+d(g.value)+'"',1)])):(n(),r("div",L,[(n(!0),r(v,null,m(p.value,s=>(n(),r("div",{key:s.id,onClick:e=>{return a=s.id,h.push(`/streamer/${a}`),k.value=!1,void(g.value="");var a},class:"result-item"},[o("div",O,[s.profileImage?(n(),r("img",{key:0,src:s.profileImage,alt:s.username,class:"avatar-img"},null,8,x)):(n(),r("div",B,d(s.username.charAt(0).toUpperCase()),1))]),o("div",D,[o("div",J,d(s.username),1),o("div",$,d(s.bio||"Sin descripciÃ³n"),1),s.isStreaming?(n(),r("div",M," ðŸ”´ En vivo ")):l("",!0)]),e[4]||(e[4]=o("div",{class:"result-arrow"},"â†’",-1))],8,E))),128))]))])):l("",!0)]))}},[["__scopeId","data-v-7d993cc5"]]),P={class:"notification-bell"},T={key:0,class:"notification-badge"},H={key:0,class:"notifications-panel"},K={class:"panel-header"},j={class:"notifications-list"},F={key:0,class:"no-notifications"},V=["onClick"],z={class:"notification-content"},q={class:"notification-message"},G={class:"notification-time"},Q={key:0,class:"unread-dot"},W={key:0,class:"panel-footer"},X=S({__name:"NotificationBell",setup(s){const e=b(),c=a(!1),u=h(()=>e.getUserNotifications().slice(0,10)),g=h(()=>e.unreadNotifications),p=()=>{c.value=!c.value},k=()=>{e.markAllNotificationsAsRead()},_=s=>{const e=new Date(s),a=new Date,t=Math.floor((a-e)/6e4);if(t<1)return"Ahora";if(t<60)return`Hace ${t} min`;if(t<1440){return`Hace ${Math.floor(t/60)}h`}return`Hace ${Math.floor(t/1440)}d`},w=s=>{s.target.closest(".notification-bell")||(c.value=!1)};return t(()=>{document.addEventListener("click",w)}),i(()=>{document.removeEventListener("click",w)}),(s,a)=>(n(),r("div",P,[o("div",{class:"bell-container",onClick:p},[a[0]||(a[0]=o("div",{class:"bell-icon"},"ðŸ””",-1)),g.value>0?(n(),r("div",T,d(g.value>99?"99+":g.value),1)):l("",!0)]),c.value?(n(),r("div",H,[o("div",K,[a[1]||(a[1]=o("h3",null,"Notificaciones",-1)),u.value.length>0?(n(),r("button",{key:0,onClick:k,class:"mark-all-read"}," Marcar todas como leÃ­das ")):l("",!0)]),o("div",j,[0===u.value.length?(n(),r("div",F,a[2]||(a[2]=[o("div",{class:"no-notif-icon"},"ðŸ“­",-1),o("p",null,"No tienes notificaciones",-1)]))):l("",!0),(n(!0),r(v,null,m(u.value,s=>(n(),r("div",{key:s.id,class:f(["notification-item",{unread:!s.read}]),onClick:a=>{return t=s.id,void e.markNotificationAsRead(t);var t}},[o("div",z,[o("div",q,d(s.message),1),o("div",G,d(_(s.createdAt)),1)]),s.read?l("",!0):(n(),r("div",Q))],10,V))),128))]),u.value.length>5?(n(),r("div",W,a[3]||(a[3]=[o("button",{class:"view-all-btn"},"Ver todas las notificaciones",-1)]))):l("",!0)])):l("",!0)]))}},[["__scopeId","data-v-0f193f51"]]),Y={class:"navbar"},Z={class:"container"},ss={class:"navbar-content"},es={class:"navbar-brand"},as={class:"navbar-nav"},ts={class:"navbar-search"},is={class:"navbar-right"},rs={key:0,class:"chococoins-display"},ns={class:"coins-container"},os={class:"coins-amount"},ls={key:1,class:"notification-bell"},cs={key:2,class:"user-menu"},us={class:"user-avatar"},ds=["src","alt"],vs={key:1,class:"avatar-placeholder"},ms={class:"username"},hs={key:0,class:"dropdown-menu"},fs={key:3,class:"auth-buttons"},gs=S({__name:"NavigationBar",setup(s){const c=e(),u=b(),v=a(!1),m=()=>{v.value=!v.value},h=()=>{v.value=!1},f=()=>{u.logout(),h(),c.push("/")},S=s=>{s.target.closest(".user-menu")||(v.value=!1)};return t(()=>{document.addEventListener("click",S)}),i(()=>{document.removeEventListener("click",S)}),(s,e)=>{const a=g("router-link");return n(),r("nav",Y,[o("div",Z,[o("div",ss,[o("div",es,[p(a,{to:"/",class:"brand-link"},{default:k(()=>e[0]||(e[0]=[o("div",{class:"logo"},[o("span",{class:"logo-text"},"CAK")],-1),o("span",{class:"brand-name"},"Streamers",-1)])),_:1,__:[0]})]),o("div",as,[p(a,{to:"/about",class:"nav-link"},{default:k(()=>e[1]||(e[1]=[_("Sobre CAK",-1)])),_:1,__:[1]}),p(a,{to:"/contact",class:"nav-link"},{default:k(()=>e[2]||(e[2]=[_("Contacto",-1)])),_:1,__:[2]}),p(a,{to:"/terms",class:"nav-link"},{default:k(()=>e[3]||(e[3]=[_("TÃ©rminos",-1)])),_:1,__:[3]})]),o("div",ts,[p(R)]),o("div",is,[w(u).isLoggedIn?(n(),r("div",rs,[o("div",ns,[e[4]||(e[4]=o("span",{class:"coins-icon"},"ðŸ«",-1)),o("span",os,d(w(u).userBalance),1),e[5]||(e[5]=o("span",{class:"coins-label"},"ChococCoins",-1))])])):l("",!0),w(u).isLoggedIn?(n(),r("div",ls,[p(X)])):l("",!0),w(u).isLoggedIn?(n(),r("div",cs,[o("div",{class:"dropdown",onClick:m},[o("div",us,[w(u).user.profileImage?(n(),r("img",{key:0,src:w(u).user.profileImage,alt:w(u).user.username,class:"avatar-img"},null,8,ds)):(n(),r("div",vs,d(w(u).user.username.charAt(0).toUpperCase()),1))]),o("span",ms,d(w(u).user.username),1),e[6]||(e[6]=o("span",{class:"dropdown-arrow"},"â–¼",-1))]),v.value?(n(),r("div",hs,[p(a,{to:"/profile",class:"dropdown-item",onClick:h},{default:k(()=>e[7]||(e[7]=[o("span",{class:"item-icon"},"ðŸ‘¤",-1),_(" Mi Perfil ",-1)])),_:1,__:[7]}),w(u).isAdmin?(n(),y(a,{key:0,to:"/admin",class:"dropdown-item admin-item",onClick:h},{default:k(()=>e[8]||(e[8]=[o("span",{class:"item-icon"},"âš™ï¸",-1),_(" Panel Admin ",-1)])),_:1,__:[8]})):l("",!0),e[10]||(e[10]=o("div",{class:"dropdown-divider"},null,-1)),o("button",{onClick:f,class:"dropdown-item logout-item"},e[9]||(e[9]=[o("span",{class:"item-icon"},"ðŸšª",-1),_(" Cerrar SesiÃ³n ",-1)]))])):l("",!0)])):(n(),r("div",fs,[p(a,{to:"/login",class:"btn btn-secondary btn-small"},{default:k(()=>e[11]||(e[11]=[_(" Iniciar SesiÃ³n ",-1)])),_:1,__:[11]}),p(a,{to:"/register",class:"btn btn-primary btn-small"},{default:k(()=>e[12]||(e[12]=[_(" Registrarse ",-1)])),_:1,__:[12]})]))])])])])}}},[["__scopeId","data-v-668cee98"]]);export{gs as N,S as _,b as u};
